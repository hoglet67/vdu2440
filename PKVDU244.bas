
10 REM VDU-PK
20 REM 40*24 VDU
30 REM VERSIE 1.5
40 REM P.KUYPER
50 REM 2-5-83///074-919652
60 REM ZERO PAGE:
70 REM PERMANENT:
80 C=#E1;F=#8F;H=#8E;V=#8D
90 REM TYDELYK:
100 D=#DC;E=#80;B=#81;G=#82
110 REM BASE ADRESS:
120 Q=#7800
130 REM~~~~
140 Q=Q+#300
150 DIMPP51,QQ25,LL29
160 FORX=0TO107;PPX=-1;N.
170 P.$21
180 FORT=1TO2
190 P=Q;R=Q/256
200 FORX=0TO9;P?X=PP(20+X);N.;P=P+10
210[
220\ctrl
230:PP21DEC C;BPLPP45;LDA@3;STA C;:PP45BEQPP46;DEC#DE
240:PP46BPLPP20;LDA H;SEC;SBC@1;STA#DE;DEC#DF;BMIPP20
250:PP22INC C;LDA C;CMP@1;BEQPP44;INC#DE;:PP44CMP@4;BCCPP20;LDA@0;STA C
260LDA#DE;CMP H;BCCPP20;JSRPP23;LDA@0;STA#DE
270:PP20RTS
280:PP24DEC#DF;BMIPP34;INC#DF;:PP34RTS
290:PP25LDA V;CLC;ADC@#7F;STA#DF;LDY@0;STY#DE;:PP35JSRPP50
300DEC#DF;BMIPP35
310:PP29LDA@#F0;STA#B000;LDA@#80;STA#DF;LDA#E6;BMIPP26;LDA V;STA#E6
320:PP26LDA@0;STA C;STA#DE;RTS
330:PP27LDX V;BPLPP36
340:PP28LDX@#80;:PP36STX#E6;RTS
350:PP23LDY#E6;BMIPP30;DEY;BNEPP19;:PP18JSR#FE71;BCSPP18
360LDY V;:PP19STY#E6;:PP30INC#DF;LDA V;ORA@#80;TAX;CPX#DF;BEQPP33;BCCPP29;RTS;:PP33LDA#DE;PHA;LDY@#81;STY#DF;DEY;STY#E3
370LDY@0;STY#DE;STY#E2;:PP31LDA(#DE),Y;STA(#E2),Y;INY;BNEPP31;INC#DF;INC#E3;CPX#DF;BNEPP31
380DEC#DF;JSRPP50;PLA;STA#DE;RTS
390:PP50BIT F;BMIPP49;DEY;:PP49TYA;LDY@0
400:PP32STA(#DE),Y;INY;BNEPP32;RTS
410\wrch
420:PP5JSR#FEFB;PHP;PHA;CLD;STY#E5;STX#E4;BIT#B001;BMIPP51;BVSPP51;JSR#FB8A;:PP51LDY@0;CMP@#13
430BEQLL11;CMP@#14;BNELL13;LDA@#AA;STA#3FE;LDA@#F7;STA#3FF
440LDY@#F0;:LL11STY#B000;LDA@12;:LL13LDY#B000;BMILL7;JMP#FE5C;:LL7JSRPP14;JMP#FE5F
450:PP14CMP@21;BEQPP38;CMP@6;BNEPP39;CLC;:PP38JMP#FD11
460:PP39LDY#E0;BMILL29;PHA;JSRPP6;PLA
470CMP@#20;BCCPP15;CMP@#7F;BEQPP37;JSRPP7;JSRPP22
480:PP6LDY@#E0;LDA C;BEQPP40;CMP@1;BEQPP41;CMP@2;BEQPP42
490:PP43LDA(#DE),Y;EOR@#3F;STA(#DE),Y;:LL29RTS
500:PP42LDA(#DE),Y;EOR@#F;STA(#DE),Y;INY;LDA(#DE),Y;EOR@#C0;STA(#DE),Y;RTS
510:PP41LDA(#DE),Y;EOR@3;STA(#DE),Y;INY;LDA(#DE),Y;EOR@#F0;STA(#DE),Y;RTS
520:PP40LDA(#DE),Y;EOR@#FC;STA(#DE),Y;RTS
530:PP15CMP@7;BNEPP17;JSR#FD1A;:PP16JMPPP6
540:PP17LDX@9;JSR#FEC5;BNEPP16;LDAQ,X;STA#E2;LDA@R;STA#E3
550JSR#FEC1;JMPPP6
560:PP37JSRPP21;LDA@#20;JSRPP7;JMPPP6
570\print
580:PP7PHA;AND@#1F;STA#E2;PLA;ROLA;LDX@0;BCCPP48;DEX;:PP48STX G;LSRA;LSRA;LSRA;LSRA;LSRA
590 LSRA;CLC;ADC@(R-4);STA#E3;LDY@0
600 LDA C;BEQPP0;CMP@1;BEQPP1;CMP@2;BNEPP3
610:PP2LDA@#0F;STA B;:PP12LDA(#E2),Y
620 LSRA;LSRA;LSRA;LSRA;JSRPP4;BCCPP12;INC#DE;LDA@#C0;STAB
630:PP8LDA(#E2),Y;ASLA;ASLA;ASLA;ASLA;JSRPP4;BCCPP8;DEC#DE;RTS
640:PP3LDA@#3F;STA B;:PP11LDA(#E2),Y;LSRA;LSRA;JSRPP4;BCCPP11;RTS
650:PP0LDA@#FC;STA B;:PP10LDA(#E2),Y;JSRPP4;BCCPP10;RTS
660:PP1LDA@3;STA B;:PP13LDA(#E2),Y;LSRA;LSRA;LSRA;LSRA;LSRA;LSRA
670 JSRPP4;BCCPP13;INC#DE;LDA@#F0;STA B
680:PP9LDA(#E2),Y;ASLA;ASLA;JSRPP4;BCCPP9;DEC#DE;RTS
690:PP4JSRQQ22
700 LDA B;EOR@#FF;AND(#DE),Y
710 ORA E;STA(#DE),Y;CLC;TYA;ADC@#20;TAY;RTS
720:QQ22BIT F;BPLPP47;EOR@#FF;:PP47EOR G;AND B;STA E;RTS
730\copy
740:QQ23LDA@0;STA G;JSRQQ5;TAY;BNEQQ24;DEC G;JSRQQ5;TAY
750BNEQQ25;LDA@#BF;:QQ25EOR@#80;:QQ24RTS
760:QQ5LDA@(R-3);LDY@0;STA#E3;STY#E2;LDA C;BEQQQ0;CMP@1;BEQQQ1;CMP@2;BEQQQ2
770:QQ3LDA@#3F;STA B;:QQ6LDA(#E2),Y;LSRA;LSRA;JSRQQ4;BNEQQ7
780BCCQQ6;:QQ8LDA#E3;SBC@(R-4);ASLA;ASLA;ASLA;ASLA;ASLA;ORA#E2
790RTS;:QQ7JSRQQ20;BCCQQ6;RTS
800:QQ0LDA@#FC;STA B;:QQ9LDA(#E2),Y;JSRQQ4;BNEQQ10;BCCQQ9
810BCSQQ8;:QQ10JSRQQ20;BCCQQ9;RTS
820:QQ1LDA@3;STA B;:QQ11LDA(#E2),Y;LSRA;LSRA;LSRA;LSRA;LSRA
830LSRA;JSRQQ4;BNEQQ13;BCCQQ11;INC#DE;LDY@0;LDA@#F0;STA B
840:QQ12LDA(#E2),Y;ASLA;ASLA;JSRQQ4;BNEQQ14;BCCQQ12;JSRQQ8
850DEC#DE;RTS;:QQ13INC#DE;:QQ14JSRQQ20;DEC#DE;BCCQQ1;RTS
860:QQ2LDA@#F;STA B;:QQ15LDA(#E2),Y;LSRA;LSRA;LSRA;LSRA
870JSRQQ4;BNEQQ17;BCCQQ15;INC#DE;LDY@0;LDA@#C0;STA B
880:QQ16LDA(#E2),Y;ASLA;ASLA;ASLA;ASLA;JSRQQ4;BNEQQ18;BCCQQ16
890JSRQQ8;DEC#DE;RTS;:QQ17INC#DE;:QQ18JSRQQ20;DEC#DE;BCCQQ2;RTS
900:QQ4JSRQQ22;LDA(#DE),Y;CPY@#E0;BCCQQ19;EOR B
910:QQ19AND B;EOR E;STA E;TYA;CLC;ADC@#20;TAY;LDA E;RTS
920:QQ20LDY@0;INC#E2;LDA#E2;CMP@#20;BCCQQ21;STY#E2;INC#E3
930LDA#E3;CMP@R;BCCQQ21;TYA;:QQ21RTS
940\rept
950:LL1PHP;CLD;STX#E4;STY#E5;JSR#FE71;BCCLL4;:LL2;LDX@25;STX D
960:LL3JSR#FE71;BCSLL3;BCCLL6;:LL4DEC D;BEQLL5;JSR#FE66
970JSR#FE71;BCSLL2;BCCLL4;:LL5INC D;BIT#B002;BVCLL6;JSR#FB8A
980:LL6JSR#FE66;:LL0TYA;CMP@6;BEQLL9;CMP@7;BEQLL9;CMP@#E
990BEQLL10;:LL8JMP#FEB2;:LL10LDY#B000;BPLLL8;JSRQQ23;JMP#FE60
1000:LL9AND@5;ROL#B001;ROLA;JMP#FE60
1010:LL12LDA@#40;EOR F;STA F
1020\rdch
1030:LL14CPY@0;BNELL15;STY#53;:LL15JSRLL1
1040CMP@#7F;BEQLL20;CMP@#20;BCSLL17;CMP@#1B;BEQLL19
1050CMP@#18;BEQLL21;CMP@#D;BEQLL19;CMP@#11;BEQLL23
1060CMP@#12;BEQLL25;CMP@#16;BEQLL12
1070JSR#FFF4;:LL16JMPLL14
1080:LL17BIT F;BVCLL18;EOR@#80;:LL18CPY@#80;BCSLL19;INC#52
1090:LL19RTS;:LL20CPY@0;BEQLL19;CPY@#81;BCSLL19;DEC#52;RTS
1100:LL21LDY#53;BEQLL22;LDY@#40;:LL22STY#52;RTS
1110:LL23LDY@0;:LL24LDA#100,Y;CMP@#D;BEQLL16;JSR#FFF4;INY
1120BNELL24;BEQLL16;:LL25LDA#B000;EOR@#F0;STA#B000;JMPLL14
1130\init
1140:LL26LDY@3;:LL27LDALL28,Y;STA#208,Y;DEY;BPLLL27;INY;STY F
1150LDA@24;STA V;LDA@30;STA H;RTS;]
1160LL28=P
1170?P=PP5&#FF;P?1=PP5/256;P?2=LL14&#FF;P?3=LL14/256
1180P=P+3;N.;P.$6;LINKLL26;E.
1190REM PRESS CTRL 3/4
1200REM ~~~~~~~~~~~~~~
